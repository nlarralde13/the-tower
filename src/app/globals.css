@import "tailwindcss";

:root {
  color-scheme: dark;
}

:root{
  --bg:#0b0a0f; --panel:#15121d; --ink:#e8e5ff; --muted:#aaa6c7;
  --line:#2b2640; --accent:#d7c3ff; --shadow:rgba(0,0,0,.35);
}
body {
  margin: 0;
  min-height: 100dvh;
  background: 
    url("/backgrounds/tower-bg.jpg") center center / cover no-repeat fixed,
    radial-gradient(1200px 600px at 50% -10%, #1a1630 0%, #0b0a0f 55%);
  background-attachment: fixed;
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
}


html, body {
  height:100%;
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family: var(--font-sans, "Inter", "Segoe UI", system-ui, sans-serif);
}

* {
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

.tower-shell{
  min-height:100dvh; display:grid; place-items:center; padding:16px;
  background:
    radial-gradient(1200px 600px at 50% -10%, #1b1533 0%, rgba(11,10,15,1) 60%),
    linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.25));
}

.menu-panel{
  width:100%; max-width:420px;
  background:linear-gradient(180deg, #1b1727, #13101a);
  border:1px solid var(--line);
  border-radius:24px;
  box-shadow: 0 12px 24px var(--shadow), inset 0 0 0 1px rgba(255,255,255,.02);
  padding:18px 16px 14px;
}

.panel-title{
  font-size:18px; font-weight:700; text-align:center; margin:4px 0 12px;
  letter-spacing:.02em;
}

.menu-list{
  list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:10px;
}

.menu-link{
  display:grid; grid-template-columns:1fr auto; grid-template-rows:auto auto; gap:0 10px;
  align-items:center; text-decoration:none; color:inherit;
  padding:14px 14px; border-radius:16px;
  background:rgba(255,255,255,.03);
  border:1px solid var(--line);
  box-shadow: 0 2px 0 rgba(0,0,0,.2);
  transition: transform .02s ease, background .15s ease;
}
.menu-link:active{ transform: translateY(1px); }

.menu-label{ grid-column:1 / 2; grid-row:1; font-weight:700; }
.menu-sub{ grid-column:1 / 2; grid-row:2; font-size:12px; color:var(--muted); }
.menu-chev{ grid-column:2 / 3; grid-row:1 / 3; align-self:center; opacity:.7; font-size:20px; }

@media (pointer:coarse){
  .menu-link{ min-height:56px; }
}

.topbar{
  position:sticky; top:0; z-index:10;
  display:flex; align-items:center; justify-content:space-between;
  height:48px; padding:0 12px;
  background:rgba(19,17,26,.7); border-bottom:1px solid var(--line);
  backdrop-filter: blur(6px) saturate(120%);
}
.userbox{display:flex; align-items:center; gap:10px; min-width:0}
.avatar{width:28px; height:28px; border-radius:50%; object-fit:cover; border:1px solid var(--line)}
.avatar--fallback{display:grid; place-items:center; background:#2a2440; color:var(--accent); width:28px; height:28px; border-radius:50%}
.who{font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:60vw}
.link{background:none; border:none; color:var(--accent); padding:8px 10px; font-weight:600}

.screen{min-height:100dvh; display:flex; flex-direction:column; align-items:center; padding:40px 24px; text-align:center; gap:16px;}
.screen.center{justify-content:center;}
.logo{font-size:32px; letter-spacing:0.2em;}
.tag{font-size:14px; color:var(--muted); margin-bottom:12px;}
.loader{font-size:14px; color:var(--muted);}
.btn{display:inline-flex; align-items:center; justify-content:center; border-radius:12px; padding:0 18px; height:44px; font-weight:600; border:1px solid transparent; background:rgba(255,255,255,0.06); color:var(--ink); cursor:pointer;}
.btn.primary{background:var(--accent); color:#1a1525; box-shadow:0 6px 12px rgba(0,0,0,0.35);}
.btn.idp{flex:1; background:rgba(255,255,255,0.05); border:1px solid var(--line);}
.idp-row{display:flex; gap:12px; width:100%; max-width:320px; margin:0 auto;}
.divider{font-size:12px; color:var(--muted); margin:16px 0; text-transform:uppercase; letter-spacing:0.1em;}
/* ===== CRT THEME ===== */
:root {
  --crt-scanline-opacity: .12;   /* 0–.25 */
  --crt-vignette-opacity: .35;   /* 0–.6  */
  --crt-noise-opacity: .035;     /* 0–.08 */
  --crt-flicker-min: .96;
  --crt-flicker-max: 1;
}

/* Turn on CRT by adding .crt to <html> */
html.crt body {
  position: relative;
  isolation: isolate; /* keep overlays above page but below modals if any */
}

/* Vignette */
html.crt body::before {
  content: "";
  position: fixed; inset: 0;
  pointer-events: none;
  background:
    radial-gradient(120% 120% at 50% 50%, rgba(0,0,0,0) 60%, rgba(0,0,0,var(--crt-vignette-opacity)) 100%);
  z-index: 1; /* below scanlines/noise */
}

/* Scanlines + subtle RGB mask drift */
html.crt body::after {
  content: "";
  position: fixed; inset: 0;
  pointer-events: none;
  z-index: 2;
  background:
    /* faint RGB subpixel trick */
    linear-gradient(0deg, rgba(255,0,0,.03), rgba(0,255,255,.03)),
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,var(--crt-scanline-opacity)) 0px,
      rgba(255,255,255,var(--crt-scanline-opacity)) 1px,
      rgba(0,0,0,0) 2px,
      rgba(0,0,0,0) 4px
    );
  mix-blend-mode: overlay;
  animation: crt-drift 7s linear infinite, crt-flicker 2.4s steps(2, end) infinite;
  will-change: transform, opacity;
}

/* Noise layer (very light) */
html.crt .crt-noise {
  position: fixed; inset: 0;
  pointer-events: none;
  z-index: 3;
  opacity: var(--crt-noise-opacity);
  background-image:
    url("data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' width='128' height='128'>\
        <filter id='n'><feTurbulence type='fractalNoise' baseFrequency='.95' numOctaves='2' stitchTiles='stitch'/></filter>\
        <rect width='100%%' height='100%%' filter='url(#n)' opacity='.9'/>\
      </svg>");
  background-size: 256px 256px;
  animation: crt-noise 1.2s steps(4,end) infinite;
  will-change: transform;
}

/* Subtle bloom + aberration for text */
html.crt body, html.crt .menu-panel, html.crt .menu-link {
  filter: saturate(110%) contrast(102%);
}
html.crt .panel-title, html.crt .menu-label {
  text-shadow:
    0 0 6px rgba(197,163,255,.18),
    1px 0 0 rgba(255,0,0,.08),
   -1px 0 0 rgba(0,255,255,.08);
}

/* Animations */
@keyframes crt-drift {
  0%   { transform: translateY(0px); }
  50%  { transform: translateY(-0.5px); }
  100% { transform: translateY(0px); }
}
@keyframes crt-flicker {
  0%   { opacity: var(--crt-flicker-max); }
  50%  { opacity: var(--crt-flicker-min); }
  100% { opacity: var(--crt-flicker-max); }
}
@keyframes crt-noise {
  0%   { transform: translate(0,0); }
  25%  { transform: translate(-5%, 3%); }
  50%  { transform: translate(4%, -2%); }
  75%  { transform: translate(-3%, -4%); }
  100% { transform: translate(0,0); }
}

/* Respect accessibility */
@media (prefers-reduced-motion: reduce) {
  html.crt body::after,
  html.crt .crt-noise {
    animation: none;
  }
}
